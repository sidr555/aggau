/**
 * Created by sidr on 20.01.14.
 * Модуль настроек
 */

var nconf = require('nconf');
nconf.argv().env();
nconf.file({file: __dirname + '/../config.json'});

module.exports = function(key, nodeEnv) { // second arg is for testing purpose
    if (key == 'NODE_ENV') {
        return process.env.NODE_ENV || 'development';
    }

    if (!nodeEnv) {
        nodeEnv = nconf.get('NODE_ENV') || process.env.NODE_ENV || 'development';
    }

    var value = nconf.get(nodeEnv + ':' + key);
    if (typeof value == 'undefined') {
        value = nconf.get(key);
    }

    //log.debug('config get', key, value);
    return value;
}
